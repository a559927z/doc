-- truncate soure_emp_status;
REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-02' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-03' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-04' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-05' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-06' FROM v_dim_emp WHERE run_off_date is null;



REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-09' FROM v_dim_emp WHERE run_off_date is null;


REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-10' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-11' FROM v_dim_emp WHERE run_off_date is null;


REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-12' FROM v_dim_emp WHERE run_off_date is null;


REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-13' FROM v_dim_emp WHERE run_off_date is null;





REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', emp_key, 1, '2015-11-16' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-17' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-18' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-19' FROM v_dim_emp WHERE run_off_date is null;





REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-23' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-24' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-25' FROM v_dim_emp WHERE run_off_date is null;


REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-26' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-27' FROM v_dim_emp WHERE run_off_date is null;


REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-11-30' FROM v_dim_emp WHERE run_off_date is null;



REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 8, '2015-11-28' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 8, '2015-11-29' FROM v_dim_emp WHERE run_off_date is null;














REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 8, '2015-11-01' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 8, '2015-11-08' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 8, '2015-11-14' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 8, '2015-11-15' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 8, '2015-11-21' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 8, '2015-11-22' FROM v_dim_emp WHERE run_off_date is null;



-- ////////////////////////////////////////


REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-12-01' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-12-02' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-12-03' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-12-04' FROM v_dim_emp WHERE run_off_date is null;



REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-12-07' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-12-08' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-12-09' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-12-10' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-12-11' FROM v_dim_emp WHERE run_off_date is null;


REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-12-14' FROM v_dim_emp WHERE run_off_date is null;


REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-12-15' FROM v_dim_emp WHERE run_off_date is null;



REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-12-16' FROM v_dim_emp WHERE run_off_date is null;

REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 1, '2015-12-17' FROM v_dim_emp WHERE run_off_date is null;





CALL pro_fetch_emp_status('b5c9410dc7e4422c8e0189c7f8056b5f','3cfd3db15ffc4c119e344e82eb8cbb19');






REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 8, '2015-12-05' FROM v_dim_emp WHERE run_off_date is null;


REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 8, '2015-12-06' FROM v_dim_emp WHERE run_off_date is null;



REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 8, '2015-12-12' FROM v_dim_emp WHERE run_off_date is null;


REPLACE INTO soure_emp_status(id, customer_id, organization_id, emp_key, status_type, date)
SELECT replace(uuid(),'-', ''), 'b5c9410dc7e4422c8e0189c7f8056b5f', organization_id, emp_key, 8, '2015-12-13' FROM v_dim_emp WHERE run_off_date is null;














CALL pro_fetch_emp_status('b5c9410dc7e4422c8e0189c7f8056b5f','3cfd3db15ffc4c119e344e82eb8cbb19');


SELECT count(1) FROM emp_status ORDER BY date desc;
SELECT count(1) FROM soure_emp_status order by date desc;

-- DELETE FROM emp_status where date ='2015-11-07';
-- DELETE FROM emp_status where date ='2015-11-08';
-- DELETE FROM emp_status where date ='2015-11-14';
-- DELETE FROM emp_status where date ='2015-11-15';
